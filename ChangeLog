Sun May  9 09:50:46 1999  Godmar Back  <gback@cs.utah.edu>

	* kaffe/kaffevm/mem/gc-incremental.c: fixed warning.
	* libraries/javalib/java/util/Calendar.java: removed static
	calendars array, getInstance must return a new one every time
	* libraries/clib/native/System.c: removed unused functions.

Fri May  7 13:23:07 PDT 1999  Archie Cobbs <archie@whistle.com>

	* kaffe/kaffevm/jni.c: in NewStringUTF(), return null if the data
	does not contain valid UTF-8 characters, instead of crashing

Wed May  5 12:27:21 1999  Godmar Back  <gback@cs.utah.edu>

	* configure.in,  kaffe/kaffe/main.c,
	kaffe/kaffevm/*, kaffe/kaffevm/jit/*: extended Jason's timing scheme 
	to do more general statistics gathering; try --with-stats
	* kaffe/kaffevm/stats.[ch]: new file
	* kaffe/kaffevm/classPool.c: new file (contains parts of classMethod.c 
	that dealt with classEntryPools.
	* *.in regenerated with automake1.4a as distributed with RH 6.0

Tue May  4 12:10:46 PDT 1999  Godmar Back  <gback@cs.utah.edu>

	* kaffe/kaffevm/constants.c, kaffe/kaffevm/classMethod.c: 
	fix for race condition in class gc

Sun May  2 22:27:09 1999  Edouard Parmelan <Edouard.Parmelan@quadratec.fr>

	* kaffe/kaffevm/readClassConfig.h, kaffe/kaffevm/classMethod.c:
	fix for race condition in class gc

Sat May  1 23:06:31 1999  Godmar Back  <gback@cs.utah.edu>

	* kaffe/kaffevm/kaffe.def: fixed tableswitch bug
	test/regression/TableSwitch.java: new test

Fri Apr 30 22:40:15 PDT 1999  Archie Cobbs <archie@whistle.com>

	* java/net/{Plain}DatagramSocketImpl.java: add new methods
	getTimeToLive() and setTimeToLive()
	* java/net/DatagramPacket.java: simplify getAddress()
	* java/net/DatagramSocket.java: add connect() and disconnect()
	methods and some missing security checks
	* ibraries/clib/awt/X/imgjpeg.c: eliminate compiler warnings

Fri Apr 30 16:20:28 1999  Godmar Back  <gback@cs.utah.edu>

	* libraries/clib/net/PlainDatagramSocketImpl.c: zero out hostname
	in inetaddress of received packet when overwriting addr
	in socket.receive().  Fixes bug #85

Fri Apr 30 11:38:40 PDT 1999  Edouard Parmelan <Edouard.Parmelan@quadratec.fr>

	* kaffe/kaffevm/systems/unix-jthreads/config-jthreads.h:
	fix backwards definition of FD_COPY() macro
	* kaffe/kaffevm/systems/unix-jthreads/jthread.c: adjust comment
	* libraries/clib/net/InetAddressImpl.c: eliminate warning

1999-04-29  Alexandre Oliva  <oliva@dcc.unicamp.br>

	* acinclude.m4, ltconfig, ltmain.sh: Update from libtool 1.3.
	Minor fixes, particularly for Cygwin, SunOS4, BeOS and HP/UX, and
	improvements for IRIX, OSF and Solaris 2.6+.
	* libltdl/acinclude.m4: Update from libtool 1.3.
	* configure.in: Moved AC_LIBLTDL_CONVENIENCE before
	AM_PROG_LIBTOOL.
	* aclocal.m4, configure, */Makefile.in: Rebuilt.
	* libltdl/aclocal.m4, configure, Makefile.in: Rebuilt.

Wed Apr 28 22:21:19 1999  Godmar Back  <gback@cs.utah.edu>

	* kaffe/kaffevm/errors.h, kaffe/kaffevm/exception.c,
	kaffe/kaffevm/support.c, kaffe/kaffevm/support.h,
	libraries/clib/net/InetAddressImpl.c:  implemented SignalErrorf,
	a printf-like version of SignalError.

Wed Apr 28 15:45:04 PDT 1999  Archie Cobbs <archie@whistle.com>

	* java/lang/ExceptionInInitializer.java: don't append a null
	exception message
	* test/regression/ProcessClassTest.java: adjust expected output

1999-04-27  Pavel Roskin <pavel_roskin@geocities.com>

	* libraries/clib/awt/X/gra.c, img.c, tlk.c, toolkit.h:
	Work around the lack of XShm support.

Sun Apr 25 20:15:52 PDT 1999 Archie Cobbs <archie@whistle.com>

	* java/lang/String.java: fix race condition
	* java/io/PrintStream.java: restore JDK compatibility tweaks
	* java/lang/System.java: put private constructor back in
	* test/regression/Reflect.java: sort output

1999-04-25  Alexandre Oliva  <oliva@dcc.unicamp.br>

	* libraries/javalib/Klasses.jar: Regen.

1999-04-25  Aaron Place  <beavis@ihug.co.nz>

	* libraries/clib/io/RandomAccessFile.c: change constructor to
	throw FileNotFoundException 
	* libraries/javalib/java/io/ObjectStreamClass.java,
	ObjectStreamConstants.java, kaffe/io/ObjectStreamClassImpl.java:
	replace SC_WRRD_METHODS with SC_WRITE_METHOD and add jdk1.2
	constants
	* libraries/javalib/java/io/PipedInputStream.java: rename pipe to
	buffer and make protected and fix EOS bug (now passes mauve test)
	(available): new method
	* libraries/javalib/java/io/PrintWriter.java: rename strm to
	out and make protected
	* libraries/javalib/java/io/StringWriter.java (StringWriter): make 
	public
	* libraries/javalib/java/lang/Long.java (parseLong): should throw
	NumberFormatException
	* libraries/javalib/java/lang/Math.java (toDegrees): new method
	(toRadians): new method
	* libraries/javalib/java/lang/reflect/Modifier.java: add strictfp
	modifier
	* libraries/javalib/java/net/SocketOptions.java: make public
	* libraries/javalib/java/text/ChoiceFormat.java (parse): fix
	* libraries/javalib/java/text/DateFormat.java, NumberFormat.java:
	do not implement Cloneable, the superclass does already
	* libraries/javalib/java/util/AbstractCollection.java,
	AbstractList.java: make constructor protected
	* libraries/javalib/java/util/zip/Deflater.java (setStrategy): change
	signature
	* libraries/javalib/java/util/zip/GZIPInputStream.java: make most
	constants default access
	* libraries/javalib/java/util/zip/Inflater.java (init): make private
	* libraries/javalib/java/util/zip/ZipEntry.java: make Cloneable

1999-04-25  Robert Zawiasa  <rhz@bibl.u-szeged.hu>

	* libraries/clib/awt/X/fnt.c: If we can't find a slanted font with 
	slant = "i", try "o".
	* libraries/javalib/java/applet/Applet.java (resize): resize base
	object too.
	* libraries/javalib/java/beans/PropertyChangeEvent.java
	(setPropagationId): Missing `this.' in assignment.
	* libraries/javalib/java/beans/PropertyVetoException.java
	(constructor): Likewise.
	* libraries/javalib/java/lang/reflect/Member.java (PUBLIC,
	DECLARED): Fix constants to be equal to JDK.

1999-04-23  Alexandre Oliva  <oliva@dcc.unicamp.br>

	* configure.in: Add -L and -R switches to LIBS, not LDFLAGS, so
	that we don't use a pre-installed libkaffevm in /usr/local/lib.
	* aclocal.m4, configure, */Makefile.in: Regen.

Fri Apr 23 11:12:16 PDT 1999	Tim Wilkinson	<tim@transvirtual.com>

	* TVT custom source merge.

Fri Apr 23 10:38:06 1999  Godmar Back  <gback@cs.utah.edu>

	* libraries/javalib/kaffe/io/ObjectStreamClassImpl.java: added
	handling for byte arrays.

Thu Apr 22 09:38:32 PDT 1999  Robert Zawiasa <rhz@bibl.u-szeged.hu>

	* libraries/javalib/kaffe/net/www/protocol/http/HttpURLConnection.java:
	MIME headers are case-insensitive, so compare them that way.

Thu Apr 22 09:34:37 PDT 1999  Pavel Roskin <pavel_roskin@geocities.com>

	* libraries/javalib/java/awt/widgets/RowCanvas.java,
	libraries/javalib/java/awt/CardLayout.java: Fixes to avoid
	NullPointerExceptions, prompted by running ICQJava

1999-04-22  Alexandre Oliva  <oliva@dcc.unicamp.br>

	* libraries/javalib/java/math/BigInteger.java: Make prime
	generator more efficient by skipping even numbers other than 2.

	* libraries/javalib/java/math/BigInteger.java: Define ZERO and ONE 
	constants.  Fix BigInteger(byte[]).  Detect error conditions in
	BigInteger(int,byte[]).  Implement BigInteger(int,Random).
	Implement BigInteger(int,int,Random) in a dumb way, awaiting for
	complete specification from Sun.  New private BigInteger(long).
	Use it for valueOf(long).  Use ZERO in signum().  Implement
	bigLength(), bitCount() and toByteArray().  Improve longValue().
	* libraries/clib/math/BigInteger.c: Implement assignLong0,
	bitLength0 and hamDist0 (used in bitCount).

	* kaffe/kaffevm/Makefile.am (jit/icode.h): Avoid dependency
	problem with intrp build after jit dist.
	* kaffe/kaffevm/Makefile.in: Regen.

	* configure.in: Check for DGifOpen in libungif.
	* configure: Regen.

1999-04-20  Alexandre Oliva  <oliva@dcc.unicamp.br>

	* FAQ/FAQ.requiredlibraries: Completed.
	* configure.in: Do not check for libgif, only libungif, and only
	if gif_lib.h indicates it's at least libungif 4.
	* configure, config/config.h.in: Regen.

1999-04-18  Alexandre Oliva  <oliva@dcc.unicamp.br>

	* kaffe/kaffevm/intrp/Makefile.am: Use KVMLIBFLAGS to build
	convenience libraries that will go into libkaffevm.la.
	* kaffe/kaffevm/jit/Makefile.am: Likewise.
	* kaffe/kaffevm/systems/beos-native/Makefile.am: Likewise.
	* kaffe/kaffevm/systems/linux-threads/Makefile.am: Likewise.
	* kaffe/kaffevm/systems/oskit-pthreads/Makefile.am: Likewise.
	* kaffe/kaffevm/systems/unix-jthreads/Makefile.am: Likewise.
	* kaffe/kaffevm/intrp/Makefile.in: Regen.
	* kaffe/kaffevm/jit/Makefile.in: Regen.
	* kaffe/kaffevm/systems/beos-native/Makefile.in: Regen.
	* kaffe/kaffevm/systems/linux-threads/Makefile.in: Regen.
	* kaffe/kaffevm/systems/oskit-pthreads/Makefile.in: Regen.
	* kaffe/kaffevm/systems/unix-jthreads/Makefile.in: Regen.

	* libraries/javalib/java/lang/reflect/Method.java (equals): Must
	also compare name and return type.

Fri Apr 16 11:48:54 EDT 1999  Pavel Roskin <pavel_roskin@geocities.com>

	* libraries/javalib/java/net/URL.java: fix equals() when ref == null

1999-04-16  Alexandre Oliva  <oliva@dcc.unicamp.br>

	* configure.in: Test whether we get an unexpected arithmetic
	exception for LONG_LONG_MIN % -1ll.
	* kaffe/kaffevm/intrp/icode.h (rem_long): Work around the bug.
	* configure, config/config.h.in: Regenerated.

	* kaffe/kaffevm/support.c (callMethodA): Add a `promoted'
	argument, that indicates whether sub-integer types have been
	promoted to int or not, and whether the result is to remain
	promoted or not.
	* kaffe/kaffevm/support.h (callMethodA): Update declaration.
	* kaffe/kaffevm/jni.c: Call callMethodA with promoted==0.
	* kaffe/kaffevm/intrp/machine.c: Call it with promoted==1.
	* kaffe/kaffevm/classMethod.c: Likewise; no arguments or result.
	* kaffe/kaffevm/gcFuncs.c: Likewise.

	* kaffe/kaffevm/intrp/machine.c (virtualMachine): Move the VM loop 
	into a separate function, runVirtualMachine(), that won't be
	affected by potential register problems related with setjmp, that
	remains in virtualMachine().  This has reduced the number of
	volatile variables referenced within the VM loop to zero, which
	should probably speed things up, at the cost a some additional
	stack space.  This has fixed almost all problems in sparc/intrp.

1999-04-15  Alexandre Oliva  <oliva@dcc.unicamp.br>

	* config/alpha/sysdepCallMethod.h (sysdepCallMethod):
	Unfortunately, floats can't be promoted to doubles, so we have to
	explicitly test each argument whether it must be loaded as double, 
	float or long.  So, define PROMOTE_jfloat2jdouble to 0.
	* kaffe/kaffevm/support.c: Reintroduce PROMOTE_jfloat2jdouble and
	PROMOTE_jint2jlong, for finer-grained control on promotion.  We
	could have done with just PROMOTE_jint2jlong, but so what?
	* config/alpha/osf/config.frag: We need -mieee in CFLAGS for
	DoublePrint and DoubleComp to pass.
	* config/alpha/linux/config.frag: Likewise.
	* config/alpha/osf/md.c (init_md): IEEE_TRAP_ENABLE_INV breaks
	them too.  Now we pass all tests!
	* config/alpha/linux/md.c (init_md): Likewise.
	
Thu Apr 15 15:00:14 1999  Godmar Back  <gback@cs.utah.edu>

	* libraries/clib/native/ObjectStreamClassImpl.c: don't include
	<clinit> twice when computing serialVersionUID

1999-04-15  Alexandre Oliva  <oliva@dcc.unicamp.br>

	* config/sparc/sysdepCallMethod.h (sysdepCallMethod): Moved from
	common.h.  Make it inlinable for short argument lists, by calling
	an alternate definition when there are too many arguments to pass
	in the registers.  It's still possible to get a single version
	with an appropriate #define.
	* config/sparc/common.h: Include sysdepCallMethod.h twice, once to 
	define the non-inlinable longSysdepCallMethod, once to define the
	inlinable sysdepCallMethod.
	* config/alpha/sysdepCallMethod.h (sysdepCallMethod): Likewise,
	but default to the single version in egcs 1.1.*, because it
	egcs crashes otherwise.  The bug is fixed in older releases and
	newer snapshots.
	* config/alpha/common.h: Likewise.
	* kaffe/kaffevm/support.c (PROM_DIV): Removed; use NO_HOLES.
	(PROMOTE_jint2jlong, PROMOTE_jfloat2jdouble): Removed; use
	PROMOTE_TO_64bits instead.
	(NO_HOLES): Semantically similar to PROM_DIV-1, but it allows
	proper implementation of jfloat2jdouble promotion.  Do not modify
	callsize.
	(ALIGN_AT_64bits): Operate only on jlongs and jdoubles.  Do not
	modify callsize.
	(ENSURE_ALIGN64): Accept one argument to adjust args.
	(callMethodA): Adjust args whenever we promote jfloat2jdouble, 
	remove a hole after a jlong or jdouble (even a promoted
	one), or insert a hole because of alignment.
	* config/mips/n32-sysdepCallMethod.h (sysdepCallMethod): Moved
	from mips.c.  Rewritten as a static inline function, similar with
	the ones for alpha.  Define NO_HOLES.
	* config/mips/o32-sysdepCallMethod.h (sysdepCallMethod): Likewise.
	Define ALIGN_AT_64bits.
	* config/mips/common.h: Include the appropriate sysdepCallMethod.
	If it cannot determined which one to use, print an error.
	* config/mips/mips.c: Removed.
	* config/mips/irix5/md.c: Do not include mips/mips.c.
	* config/mips/linux/md.c: Likewise.
	* config/mips/ultrix4/md.c: Removed definition of
	sysdepCallMethod, it's o32 ABI.  It may fail to select it, though, 
	and some #define may be needed.
	* config/Makefile.am (EXTRA_DIST): Removed mips/mips.c.  Added
	*/*sysdepCallMethod.h.
	* config/Makefile.in: Rebuilt.
	
	* test/regression/DoubleComp.java (DoubleComp): Add try/catch
	blocks so that it reports which tests cause ArithmeticExceptions.

1999-04-14  Alexandre Oliva  <oliva@dcc.unicamp.br>

	* config/i386/common.h (sysdepCallMethod): Do not use extern
	inline, it prevents compilation without optimization; use static
	inline instead.
	* config/sparc/common.h (sysdepCallMethod): Rewrite as a static
	inline function, in a well-documented way, suitable for easy
	adaptation to other platforms, without *any* asm statement.
	* kaffe/kaffevm/support.c (PROMOTE_TO_64bits): Define
	PROMOTE_jint2jlong and PROMOTE_jfloat2jdouble.
	(PROMOTE_jint2jlong): Arrange that all integer types are promoted
	to 64bit words.  It currently doesn't cause padding arguments to
	be added if needed.
	(PROMOTE_jfloat2jdouble): Arrange that all floats are promoted to
	double.
	(PROM_DIV): If PROMOTE_jint2jlong and PROMOTE_jfloat2jdouble are
	defined, and pointers are as wide as two ints, set to 2,
	otherwise, set to 1.
	(callMethodA, callMethodV): Promote jints to jlongs and jfloats to 
	jdoubles where appropriate.  Divide all sizes of jfloats, jlongs,
	jdoubles and jrefs by PROM_DIV, and eliminate padding arguments if
	possible.
	* config/alpha/common.h (sysdepCallMethod): Rewrite as a static
	inline function very similar with the one for sparc.  Define
	PROMOTE_TO_64bits, since all arguments are 64bits, so that we
	don't have to skip holes.
	* kaffe/kaffevm/support.c (ALIGN_AT_64bits, callMethodA,
	callMethodV): If ALIGN_AT_64bits is defined, insert padding 32-bit 
	arguments as needed for 64bit ones to be aligned at even positions 
	in the array of arguments.

	* config/config.alias: Cygnus has renamed cygwin32 to cygwin, but
	our config directory is still named cygwin32.

1999-04-13  Alexandre Oliva  <oliva@dcc.unicamp.br>

	* configure.in: Modify --with-libraries so that it also adds
	directories to the run-time search path.  Drop --with-rtlibraries,
	now that it's useless.  Do not add assume -I/usr/local/include if
	--with-includes is specified, nor -L/usr/local/lib for
	--with-libraries.  If X_LIBS contains any -L flag but no -R, add
	one -R for each -L.
	* FAQ/FAQ.automake: Remove references to --with-rtlibraries.
	* configure: Rebuilt.

	* libltdl/ltdl.c: Update from libtool.  Remove warnings.  Bug
	fixes for HP/UX.

	* config/i386/common.h (sysdepCallMethod): Update comments, and
	optimize a bit further.

Mon Apr 12 10:12:25 1999  Alan L. Batongbacal <alanlb@access.rrinc.com>

	* config/i386/beos/config.frag: removed explicit definition for CFLAGS
	because it interfered with --disable-debug option

1999-04-12  Alexandre Oliva  <oliva@dcc.unicamp.br>

	* config/i386/common.h (sysdepCallMethod): Rewrite so that it
	compiles with egcs snapshots.  Make it an extern inline function,
	to ease debugging.  It will only be defined if
	NEED_sysdepCallMethod is defined.
	* kaffe/kaffevm/support.c: Include support.h and define
	NEED_sysdepCallMethod before machine.h.

Fri Apr  9 14:00:00 PDT 1999 Transvirtual Technologies <info@transvirtual.com>

        * Version 1.0.b4 of Kaffe OpenVM released.

See ChangeLog.2 for earlier changes.
